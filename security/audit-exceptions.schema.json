{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wildside.dev/schemas/audit-exceptions.json",
  "title": "Dependency audit exceptions allowlist",
  "description": "Declarative allowlist of time-bound dependency audit exceptions.",
  "type": "array",
  "minItems": 0,
  "items": {
    "type": "object",
    "additionalProperties": false,
    "required": ["id", "package", "advisory", "reason", "addedAt", "expiresAt"],
    "properties": {
      "id": {
        "type": "string",
        "minLength": 1,
        "pattern": "^[A-Z0-9][A-Z0-9_-]*$"
      },
      "package": {
        "type": "string",
        "minLength": 1
      },
      "advisory": {
        "type": "string",
        "minLength": 1,
        "pattern": "^GHSA-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}$"
      },
      "reason": {
        "type": "string",
        "minLength": 1
      },
      "introducedBy": {
        "type": "string",
        "minLength": 1
      },
      "addedAt": { "type": "string", "format": "date" },
      "expiresAt": { "type": "string", "format": "date" },
      "reviewer": { "type": "string", "format": "email" }
    }
  }
}
